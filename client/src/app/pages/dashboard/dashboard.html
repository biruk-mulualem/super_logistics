<div id="dashboard_page" class="dashboard-wrapper">
  <app-sidebar></app-sidebar>

  <div class="main">
    <app-header></app-header>

    <div class="dashboard-content">

      <h1 class="dashboard-title">Dashboard</h1>

      <!-- Grid Cards -->
      <div class="dashboard-grid">
        <div class="card payment-status-card">
          <h3> Advance Payment</h3>

          <div class="status-item advance-payment">

           <span class="status-count">{{ advancePayment }}</span>
          </div>

        </div>

        <div class="card payment-status-card">
          <h3> Pending Payments</h3>

          <div class="status-item pending-payment">

             <span class="status-count">{{ pendingPayment }}</span>
          </div>
        </div>
        <div class="card payment-status-card">
          <h3>In Route</h3>
          <div class="status-item full-payment">

            <span class="status-count">{{inRoute}} </span>
          </div>

        </div>
        <div class="card payment-status-card">
          <h3>In Djibouti</h3>
          <div class="status-item full-payment">

            <span class="status-count">{{inDjibouti}} </span>
          </div>

        </div>
        <div class="card payment-status-card">
          <h3>In AAK</h3>
          <div class="status-item full-payment">

            <span class="status-count">{{inAak}} </span>
          </div>

        </div>
        <div class="card payment-status-card">
          <h3>In SDT</h3>
          <div class="status-item full-payment">

            <span class="status-count">{{inSdt}} </span>
          </div>

        </div>

      </div>

      <!-- Bottom Panels -->
      <div class="dashboard-grid">
        <div class="card sales">
          <!-- <h4>Total Sales</h4> -->
          <canvas id="salesChart"></canvas>
        </div>
        <div class="card sales">
          <!-- <h4>Total Sales</h4> -->
          <canvas id="salesChart"></canvas>
        </div>
        <div class="card sales">
          <!-- <h4>Total Sales</h4> -->
          <canvas id="salesChart"></canvas>
        </div>
      </div>

      <!-- Storage Section -->
      <div class="storage-section">
        <div class="card storage-bar">
          <p>Using Storage <strong>1466 MB</strong> of 2 GB</p>
          <div class="storage-bar-inner">
            <div class="regular" style="width: 45%"></div>
            <div class="system" style="width: 20%"></div>
            <div class="shared" style="width: 10%"></div>
            <div class="free" style="width: 25%"></div>
          </div>
          <div class="legend">
            <span class="dot blue"></span> Regular
            <span class="dot purple"></span> System
            <span class="dot green"></span> Shared
            <span class="dot gray"></span> Free
          </div>
        </div>

        <div class="card storage-warning">
          <h4>Running out of your space?</h4>
          <p>Your storage will be running out soon. Get more space and powerful
            productivity features.</p>
          <a href="#">Upgrade storage â†’</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Chatbot Trigger Button -->
  <button class="chatbot-toggle" (click)="toggleChat()"
    aria-label="Toggle chatbot">ðŸ’¬</button>

  <!-- Chatbot Window -->
  <div
    class="chatbot-window"
    [class.open]="isChatOpen"
    role="dialog"
    aria-modal="true"
    aria-labelledby="chatbotTitle">
    <div class="chatbot-header">
      <h4 id="chatbotTitle">Logistics Assistant</h4>
      <button class="close-btn" (click)="toggleChat()"
        aria-label="Close chatbot">âœ–</button>
    </div>

    <div class="chatbot-body" #chatBody>
      <div
        *ngFor="let msg of messages"
        [class.user]="msg.from === 'user'"
        [class.bot]="msg.from === 'bot'"
        class="chat-message">
        <strong *ngIf="msg.from === 'user'">You:</strong>
        <strong *ngIf="msg.from === 'bot'">Bot:</strong>
        {{ msg.text }}
      </div>

      <!-- Bot Typing Indicator -->
      <div *ngIf="isBotTyping" class="bot-typing">
        <strong>Bot is typing...</strong>
      </div>
    </div>

    <div class="chatbot-input">
      <input
        type="text"
        [(ngModel)]="chatInput"
        (keyup.enter)="sendMessage()"
        placeholder="Ask something..."
        aria-label="Chat input" />
      <button
        (click)="sendMessage()"
        aria-label="Send message"
        [disabled]="isSending || !chatInput.trim()">
        âž¤
      </button>
    </div>
  </div>
</div>
